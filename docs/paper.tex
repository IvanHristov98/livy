\documentclass[a4paper,12pt]{article}

\usepackage[margin=90pt]{geometry}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[unicode]{hyperref}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{enumitem, hyperref}
\usepackage{upgreek}
\usepackage{graphicx}
\usepackage{mathtools}
\usepackage{indentfirst}
\usepackage{csquotes}
\usepackage{gensymb}

\graphicspath{ {./img/} }

\begin{document}
\title{Преддипломна работа}


\maketitle

\begin{center}на тема\end{center}

\begin{center}\textbf{Дедупликация на изображения от архиви на културни институции}\end{center}

\pagebreak

\section{Увод}

\subsection{Актуалност на проблема и мотивация}

С течение на времето се правят находки с културна стойност. Осезаема част от тях са под формата на снимки, съдържащи исторически лица редом с характерните за тяхната среда обекти. Анализът на такива снимки изисква участието на историци и етнографи. Следователно процесът е трудоемък и с възможност за допускане на субективни грешки. Дублициране на исторически изображения е възможно, било то поради невнимание при сканиране или сливане на архиви с общи снимки. Повтарянето на изображения е възможно да доведе до излишен човешки труд и съответно загубено време.

\bigbreak

Пример за институция с този пробем е Троянският музей. Той разполага с архив от \textit{4TB} снимки в \textit{JPG} формат, чиито източници варират. Някой от тях са заснети чрез фотоапарат, докато други са сканирани. Съответно те са подложени на различни афинни трансформации (ротация, скалиране, отместване и др.), дисторция и илюминация. Пример за това е, че размерите на изображенията варират от около \textit{200KB} до около \textit{10MB}. Троянският музей специализира в народните занаяти, но има и богата сбирка от градски изображения - някои от които са с тълпи от хора, други с малко на брой субекти. Съответно детайлността на изображенията варира, което би могло да бъде проблем при наличие на ниска резолюция на изображенията. Снимките от музея са исторически, съответно има наличие на черно-бели и цветни изображения.

\bigbreak

Архивът на Троянският музей със своето разнообразие е достатъчно представителен за проблема, но той далеч не е единственият такъв. Пример за подобно множество от снимки е това на Народната библиотека в Пловдив. Следователно дедупликацията на исторически изображения е проблем, чиято автоматизация би имала културен и исторически принос на много места.

\subsection{Цел и задачи на преддипломната работа}

На най-абстрактно ниво бизнес целта на преддипломната работа е да намали времето инвестирано от историци в анализ на изображения. Това не означава замяна на такива специалисти, а напротив - улеснение на тяхната работа. Постигането на тази цел е възможно, използвайки комбинация от похвати познати в обработката на изображения и изкуствения интелект. В такъв ред на мисли тази работа предоставя обзор на такива похвати, избор на комбинация от тях, обоснован от бизнес контекста, и изграждането на общодостъпен инструмент имплементиращ ги.

\bigbreak

Дедупликацията на исторически изображения е един начин да се помогне на историците. Съществува множество от други проблеми - като разпознаване на лица от снимки, категоризиране и откриване на обекти, коригиране на дефекти и прочие. Съответно тази работа може да се разглежда като стъпка към изграждането на един по-голям инструмент за разрешаването на разнообразни проблеми в работата на историците.

\subsection{Очаквани ползи от реализацията}


\subsection{Структура на преддипломната работа}

\section{Преглед на предметната област}

\subsection{Основни дефиниции}

В тази секция се обяснява какво е задачата за дедупликация на изображения, давайки дефиниция на проблемите пред нея.

\bigbreak

Казваме, че две изображения са \textbf{идентични} когато те са фотографични копия на едно оригинално изображение. Фотографично копие на оригинално изображение се получава чрез прилагане на трансформации върху него, сред които афинни, контрастни, илюминационни, дистортни и компресивни. Примери за практически методи за получаването на фотографични копия са презаснемане на изображение чрез камера или скенер. Терминът фотографично копие е \textbf{размит}, като той означава максимално сходство между изображение копие и неговия оригинал относно детайлност (виж деф.), контраст и цветове.

\bigbreak

Трябва да се прави разлика между идентични и подобни изображения. Нека $A'$ и $B'$ са изображения, като съответно $A'$ е фотографично копие на $A$ и $B'$ е фотографично копие на $B$. Нека $A$ и $B$ не са производни на други изображения, т.е. са оригинални. Казваме, че изображение $A'$ е \textbf{подобно} на изображение $B'$, ако $A$ и $B$ се различават съвсем малко по детайлност (виж деф.), контраст и цветове. Пример за практически метод за получаване на подобни изображения е няколкократно заснемане на изображение в рамките на секунда. Пример за разлика в детайлност е ако на снимка $A$ има човек с отворени очи, а на $B$ той е със затворени. Задачата за дедупликация се занимава с откриването на \textbf{идентични} изображения. На практика алгоритмите за откриване на дуплицирани изображения третират подобните и идентичните изображения по еднакъв начин. Това се налага поради размитостта на понятията. 

\bigbreak

Детайлността на едно изображение се представя чрез неговите точки на интерес. Точка на интерес наричаме регион от изображението, който е устойчив на математически операции, защото е богат на информация, има ясно дефинирано разположение в пространството и е стабилен на локални и глобални трансформации в изображението [виж sift paper]. Нека имаме изображение $A$ с две фотографични копия $B$ и $C$ и точка на интерес $\alpha$. Лесно може да се определи, къде в $B$ и къде в $C$ е проектирана $\alpha$. Следователно дефиницията за подобие/идентичност между две изображения може да се преформулира по следния начин - нека $A$ и $B$ са изображения; казваме, че $A$ и $B$ са подобни/идентични ако количеството споделени точки на интерес във всяко едно изображения надминава даден праг $p$.

\bigbreak

В практиката точка на интерес представяме като $v \in V$, където $V \subseteq \mathbb{R}^n, n \in \mathbb{N}$. Дефиницията дава свобода на всеки подход при кодирането им, като обичайно то се влияе от разположението, цветовете, ориентацията и геометрията на региона обособен от точката. Едно добро кодиране на точна на интерес е максимално независимо от афинни трансформации, илюминация и други трансформации. Казваме, че две точки на интерес са споделени когато техните векторни представания са достатъчно близки. Думата "достатъчно" е в следствие на размитата дефиниция за идентичност между две изображения.

\subsection{Подходи за решаване на проблемите}

Ще работим с дефиницията за подобие/идентичност между две изображения. Следователно първо трябва да определим кои са точките на интерес.

\subsubsection{Scale Invariant Feature Transform (SIFT)}

SIFT е един от най-успешните подходи за откриване на точки на интерес. Те са инвариантни към скалиране, ротация, отместване и частично инвариантни към промяна на илюминация и локална дисторция.  Откритите точки на интерес се явяват като апроксимация на тези, открити от главната визуална кора на приматите по това, че споделят подобно кодиране на форми и цвят. SIFT е разделен на няколко стъпки - откриване на потенциални точки на интерес, тяхната филтрация и присвояване на съответно векторно представяне.

\bigbreak

За да се открият потенциалните точки на интерес в изображение $I$ се започва с изграждането на \textbf{пространство на мащабите}. Намират се $n$ на брой октави на $I$, където над всяка октава, $k+1$ пъти последователно е приложен Гаусов филтър. Приложеният филтър на стъпка $s$ е със стандартно отклонение $\sigma_s, 0 <= s < k+1, s \in \mathbb{N}$, където $\sigma_{s+1} = 1.6 \sigma_s$. За всяка октава $i$ намираме разликата между всеки две последователно Гаусови филтрирания $j$ и $j+1$ (т.нар. разлика между Гаусови филтрирания (\textit{Difference of Gaussians (DoG)})), където $i < n, j < k, i, j \in \mathbb{N}$. Съответно пространството на мащабите се състои от $nk$ на брой изображения (виж фиг.). Нека интензитетът на точка $(x, y)$ на изображението от $j$-тото ниво на $i$-тата октава означим като $I_{ij}(x,y)$.

\bigbreak

Получените изображения апроксимират прилагането на Лапласов оператор, при който изпъкват очертанията на фигурите. Друга аналогия, ако разглеждаме $I$ като сигнал, е тази с \textit{band-pass filter}, защото прилагането на Гаусов филтър премахва високите честоти, а $DoG$ премахва честотите от по-замъгленото изображение (т.е. ниските). С други думи всяко ниво от пространството на мащабите представя конкретен честотен интервал на входното изображение $I$. За всеки такъв интервал \textit{SIFT} открива екстремални точки, които са потенциални точки на интерес. Една точка $(x, y)$ от $I_{ij}$ наричаме екстремална, ако за интензитетът ѝ $I_{ij}(x, y)$ е изпълнено $I_{ij}(x, y) >= I_{(i+r)(j+p)}(x+n, y+m) \forall r,p,n,m \in \{-1, 0, 1\}$. Тогава ако релацията за съседство дефинирана над изображението е $8$-съседство, се правят $9+8+9=26$ сравнения (виж фиг.).

\bigbreak

Някои от откритите до тук екстремални точки е възможно да са нестабилни спрямо трансформации, съответно е желателно те да бъдат премахнати. За подобрена точност, при процеса на филтрация, сигнала на изображението се конвертира от дигитален в аналогов. Точната локация на всеки екстремум $p=(x, y)$ за изображение $I_{ij}$ се апроксимира чрез \textbf{развитие на Тейлър} с център на координатната система $(x, y, \sigma_j)$: \\

$D(\varphi) = D + \frac{\partial D^T}{\partial \varphi}\varphi + \frac{\varphi^T}{2}\frac{\partial^2 D}{\partial \varphi^2}\varphi$ \\

, където $\sigma_j$ е стандартното отклонение за $I_{ij}$ и $\varphi=(x_{offset},y_{offset},\sigma_{offset})^T$ е отместване спрямо центъра на координатната система. Отместването към аналоговия екстремум $\hat{\varphi}$ намираме чрез откриване на корените на $D'$. Ако $max(\lvert\hat{\varphi}\rvert) > 0.5$, то истинският екстремум е по-близо до друга точка на интерес. Следователно изчисляваме наново $D$ с център на координатната система $(x, y, \sigma_j) + \hat{\varphi}$ и повтаряме итеративно процеса. В противен случай приемаме, че отместването на екстремума е $\hat{\varphi}$.

\bigbreak

Ако един екстремум не е достатъчно изпъкнал, т.е. $D''(\hat{\varphi}) < 0.03$, то се предполага, че той е нестабилен. Следва елиминация на точки намиращи се върху ръбове, където се използват характеристичните стойности на Хесиановата матрица на $D$. Новата локация на точката на интерес след процеса на филтрация е $(x, y, \sigma_j) + \hat{\varphi}$.

\bigbreak

Предните стъпки подсигуряват инвариантност към отместване и скалиране. Чрез тази стъпка се постига инвариантност към ротация на изображението. За дадена точка на интерес $(x, y)$ от октава $i$ със стандартно отклонение $\sigma$ наричаме съответното Гаусово филтриране $I_{\sigma}$. В околност около $(x, y)$ намираме размера и ориентацията на всеки градиент: \\

$m(x', y') = \sqrt{(I_{\sigma}(x'+1,y') - I_{\sigma}(x'-1,y'))^2 + (I_{\sigma}(x', y'+1) - I_{\sigma}(x', y'-1))^2}$ \\
$\theta(x', y') = \arctan(I_{\sigma}(x',y'+1) - I_{\sigma}(x',y'-1), I_{\sigma}(x'+1,y') - I_{\sigma}(x'-1, y'))$ \\

Създава се хистограма с 36 кофи, всяка съответстваща на интервал от $10\degree$. Всяка точка $(x', y')$ от околността $(x, y)$ се причислява към конкретна кофа според ориентацията си, като добавената стойността се претегля според магнитута и стандартното отклонение. Намира се теглото на най-тежката кофа, като оцеляват само кофите с тегло поне $0.8$ от теглото на най-тежката кофа. За всяка оцеляла кофа се създава ключова точка с тази ориентация.

\bigbreak

За изграждането на финалния дескриптор на точка на интерес се взима регион с размер $16 \times 16$ около нея. Той се разбива на 16 подрегиона, всеки с размер $4 \times 4$. За всеки регион се създава хистограма с 8 кофи. Съответно всеки дескриптор на точка на интерес има размерност $16 \times 8 = 128$. Подобно на предната стъпка, за всяка точка от този регион се намира ориентацията и магнитут. За инвариантност на ротацията и отместването се използват координатната система на точката на интерес, чиито дескриптор се пресмята. За добавена инвариантност към илюминация се извършва нормализация и подрязване на финалния дескриптор.

\subsubsection{Максимално стабилни екстремални региони (\textit{Maximally Stable Extremal Regions (MSER)})}

\subsection{Съществуващи решения}

\subsection{Избор на критерии за сравнение и сравнителен анализ на решения}
\subsection{Изводи}

\section{Използвани технологии, платформи и/или методологии}

\section{Анализ}

\section{Проектиране}

\section{Реализация, тестване/експерименти и внедряване}

\section{Заключение}

\section{Използвана литература}

\begin{enumerate}
    \item David G. Lowe. 2004. Distinctive Image Features from Scale-Invariant Keypoints. https://www.cs.ubc.ca/~lowe/papers/ijcv04.pdf
    \item T. Serre, M. Kouh, C. Cadieu, U. Knoblich, G. Kreiman, T. Poggio. 2005. A Theory of Object Recognition: Computations and Circuits in the Feedforward Path of the Ventral Stream in Primate Visual Cortex. https://serre-lab.clps.brown.edu/wp-content/uploads/2012/08/GetTRDoc.pdf
\end{enumerate}

\end{document}